<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title> Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨Ø³ÙŠØ· - Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©</title>
    
    <!-- Telegram Web App Script -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <!-- html2canvas library for screenshot -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #e8f4f8;
            --bg-secondary: #ffffff;
            --bg-tertiary: #f0f8fc;
            --text-primary: #1e3a4f;
            --text-secondary: #5a7c8f;
            --border-color: #b8d9e8;
            --accent-color: #4a90a4;
            --accent-light: #6ba5b8;
            --success-color: #5cb85c;
            --warning-color: #f0ad4e;
            --danger-color: #d9534f;
            --neutral-color: #7ea8b8;
            --shadow: 0 1px 3px rgba(74, 144, 164, 0.1);
            --shadow-hover: 0 2px 8px rgba(74, 144, 164, 0.15);
            --spacing-xs: 5px;
            --spacing-sm: 10px;
            --spacing-md: 15px;
            --spacing-lg: 20px;
            --spacing-xl: 30px;
        }

        [data-theme="dark"] {
            --bg-primary: #0f1c26;
            --bg-secondary: #1a2a35;
            --bg-tertiary: #243544;
            --text-primary: #c5e3ed;
            --text-secondary: #8fb5c7;
            --border-color: #2e4555;
            --accent-color: #5ba5c2;
            --accent-light: #7dbdd6;
            --shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
            --shadow-hover: 0 2px 8px rgba(0, 0, 0, 0.6);
        }

        body {
            font-family: 'Cairo', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-primary);
            min-height: 100vh;
            padding: var(--spacing-lg);
            color: var(--text-primary);
            transition: background 0.3s ease, color 0.3s ease;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            line-height: 1.6;
        }

        .table-wrapper {
            width: 100%;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            margin-bottom: var(--spacing-lg);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: var(--bg-secondary);
            border-radius: 8px;
            box-shadow: var(--shadow);
            overflow: hidden;
            transition: background 0.3s ease;
            border: 1px solid var(--border-color);
        }

        .header {
            background: var(--bg-secondary);
            color: var(--text-primary);
            padding: var(--spacing-xl);
            text-align: center;
            position: relative;
            border-bottom: 2px solid var(--border-color);
        }

        .theme-toggle {
            position: absolute;
            left: var(--spacing-xl);
            top: var(--spacing-xl);
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            padding: var(--spacing-sm) var(--spacing-md);
            border-radius: 6px;
            cursor: pointer;
            color: var(--text-primary);
            font-family: 'Cairo', sans-serif;
            font-weight: 500;
            transition: all 0.3s ease;
            font-size: 0.9em;
        }

        .theme-toggle:hover {
            background: var(--bg-primary);
            transform: translateY(-1px);
            box-shadow: var(--shadow);
        }

        .header h1 {
            font-size: 2.2em;
            margin-bottom: var(--spacing-sm);
            font-weight: 700;
            color: var(--text-primary);
        }

        .header p {
            font-size: 1em;
            color: var(--text-secondary);
            font-weight: 400;
        }

        .tabs {
            display: flex;
            background: var(--bg-tertiary);
            border-bottom: 1px solid var(--border-color);
        }

        .tab {
            flex: 1;
            padding: var(--spacing-md) var(--spacing-lg);
            text-align: center;
            cursor: pointer;
            background: transparent;
            border: none;
            font-size: 1em;
            font-weight: 500;
            color: var(--text-secondary);
            transition: all 0.2s;
            font-family: 'Cairo', sans-serif;
            border-bottom: 2px solid transparent;
        }

        .tab:hover {
            color: var(--text-primary);
            background: var(--bg-secondary);
        }

        .tab.active {
            background: var(--bg-secondary);
            color: var(--accent-color);
            border-bottom: 2px solid var(--accent-color);
            font-weight: 600;
        }

        .tab-content {
            display: none;
            padding: var(--spacing-xl);
        }

        .tab-content.active {
            display: block;
        }

        .section {
            margin-bottom: var(--spacing-xl);
            background: var(--bg-tertiary);
            padding: var(--spacing-lg);
            border-radius: 6px;
            border: 1px solid var(--border-color);
        }

        .section-title {
            font-size: 1.4em;
            color: var(--text-primary);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-sm);
            border-bottom: 2px solid var(--border-color);
            font-weight: 600;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: var(--bg-secondary);
            border-radius: 6px;
            overflow: hidden;
            box-shadow: none;
            border: 1px solid var(--border-color);
            margin-bottom: var(--spacing-md);
        }

        th, td {
            padding: var(--spacing-md) var(--spacing-sm);
            text-align: right;
            border-bottom: 1px solid var(--border-color);
            vertical-align: middle;
        }

        th {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            font-weight: 600;
            font-size: 0.95em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            padding: var(--spacing-md);
        }

        .category-row {
            background: var(--bg-tertiary);
            font-weight: 600;
            color: var(--text-primary);
        }

        .category-row td {
            padding: var(--spacing-md);
        }

        .subtotal-row {
            background: #fffbf0;
            font-weight: 600;
            color: var(--text-primary);
        }

        .subtotal-row td {
            padding: var(--spacing-md);
        }

        [data-theme="dark"] .subtotal-row {
            background: #2d2a1f;
        }

        .total-row {
            background: #f0f9f4;
            font-weight: 600;
            font-size: 1em;
            color: var(--success-color);
        }

        .total-row td {
            padding: var(--spacing-md);
        }

        [data-theme="dark"] .total-row {
            background: #1a2e1f;
        }

        .grand-total-row {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            font-weight: 700;
            font-size: 1.1em;
            border-top: 2px solid var(--border-color);
        }

        .grand-total-row td {
            padding: var(--spacing-lg) var(--spacing-md);
        }

        input[type="text"], input[type="number"] {
            width: 100%;
            padding: var(--spacing-sm) var(--spacing-md);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 0.95em;
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-family: 'Cairo', sans-serif;
            transition: all 0.2s ease;
            min-height: 38px;
        }

        input[type="number"] {
            max-width: 150px;
            text-align: center;
            font-weight: 600;
        }

        input[type="number"]:focus, input[type="text"]:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(73, 80, 87, 0.1);
        }

        [data-theme="dark"] input[type="number"]:focus, 
        [data-theme="dark"] input[type="text"]:focus {
            box-shadow: 0 0 0 3px rgba(88, 166, 255, 0.2);
        }

        .btn {
            padding: var(--spacing-sm) var(--spacing-md);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s;
            font-family: 'Cairo', sans-serif;
            font-size: 0.9em;
            white-space: nowrap;
        }

        .btn-add {
            background: var(--success-color);
            color: white;
            margin: var(--spacing-xs);
            border-color: var(--success-color);
        }

        .btn-add:hover {
            background: #218838;
            border-color: #218838;
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(40, 167, 69, 0.3);
        }

        .btn-remove {
            background: var(--danger-color);
            color: white;
            border-color: var(--danger-color);
        }

        .btn-remove:hover {
            background: #c82333;
            border-color: #c82333;
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(220, 53, 69, 0.3);
        }

        .btn-export {
            background: var(--accent-color);
            color: white;
            padding: var(--spacing-md) var(--spacing-xl);
            font-size: 1em;
            margin: var(--spacing-lg) auto;
            display: block;
            border-color: var(--accent-color);
        }

        .btn-export:hover:not(:disabled) {
            background: var(--text-primary);
            border-color: var(--text-primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        .btn-export:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .status-indicator {
            text-align: center;
            padding: var(--spacing-xl);
            border-radius: 6px;
            margin: var(--spacing-lg) 0;
            font-size: 1.2em;
            font-weight: 600;
            box-shadow: none;
            transition: all 0.3s ease;
            border: 2px solid var(--border-color);
            line-height: 1.8;
        }

        .status-excellent {
            background: #d4edda;
            color: #155724;
            border-color: #28a745;
        }

        [data-theme="dark"] .status-excellent {
            background: #1a2e1f;
            color: #4ade80;
        }

        .status-good {
            background: #e8f5e9;
            color: #2e7d32;
            border-color: #4caf50;
        }

        [data-theme="dark"] .status-good {
            background: #1c2e21;
            color: #86efac;
        }

        .status-balanced {
            background: #e9ecef;
            color: #495057;
            border-color: #6c757d;
        }

        [data-theme="dark"] .status-balanced {
            background: #21262d;
            color: #8b949e;
        }

        .status-bad {
            background: #fff3cd;
            color: #856404;
            border-color: #ffc107;
        }

        [data-theme="dark"] .status-bad {
            background: #2d2a1a;
            color: #fbbf24;
        }

        .status-critical {
            background: #f8d7da;
            color: #721c24;
            border-color: #dc3545;
        }

        [data-theme="dark"] .status-critical {
            background: #2e1a1d;
            color: #f87171;
        }

        .analysis-table {
            margin-top: var(--spacing-xl);
        }

        .positive {
            color: var(--success-color);
            font-weight: 700;
        }

        .negative {
            color: var(--danger-color);
            font-weight: 700;
        }

        .neutral {
            color: var(--neutral-color);
            font-weight: 700;
        }

        /* Loading overlay */
        .loading-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 9999;
            align-items: center;
            justify-content: center;
        }

        .loading-overlay.active {
            display: flex;
        }

        .loading-content {
            background: var(--bg-secondary);
            padding: var(--spacing-xl) calc(var(--spacing-xl) * 2);
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            max-width: 90%;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 6px solid var(--border-color);
            border-top: 6px solid var(--accent-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto var(--spacing-lg);
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            color: var(--text-primary);
            font-size: 1.2em;
            font-weight: 600;
            margin-bottom: var(--spacing-sm);
        }

        .loading-subtext {
            color: var(--text-secondary);
            font-size: 0.9em;
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }
            .tabs, .btn, .header, .theme-toggle {
                display: none;
            }
            .container {
                box-shadow: none;
                border: none;
            }
            .tab-content {
                display: block !important;
                padding: var(--spacing-lg);
            }
            table {
                page-break-inside: avoid;
            }
        }

        @media (min-width: 1400px) {
            :root {
                --spacing-xs: 6px;
                --spacing-sm: 12px;
                --spacing-md: 18px;
                --spacing-lg: 24px;
                --spacing-xl: 36px;
            }
            input[type="number"] {
                max-width: 180px;
            }
            .container {
                max-width: 1600px;
            }
        }

        @media (max-width: 1024px) {
            :root {
                --spacing-xs: 5px;
                --spacing-sm: 10px;
                --spacing-md: 15px;
                --spacing-lg: 20px;
                --spacing-xl: 28px;
            }
            body {
                padding: var(--spacing-md);
            }
            .header h1 {
                font-size: 2em;
            }
            input[type="number"] {
                max-width: 140px;
            }
        }

        @media (max-width: 768px) {
            :root {
                --spacing-xs: 4px;
                --spacing-sm: 8px;
                --spacing-md: 12px;
                --spacing-lg: 16px;
                --spacing-xl: 24px;
            }
            body {
                padding: var(--spacing-sm);
            }
            .container {
                border-radius: 6px;
            }
            .header {
                padding: var(--spacing-lg) var(--spacing-md);
            }
            .header h1 {
                font-size: 1.8em;
                margin-bottom: var(--spacing-xs);
            }
            .header p {
                font-size: 0.95em;
            }
            .theme-toggle {
                position: static;
                display: block;
                margin: 0 auto var(--spacing-md);
                font-size: 0.85em;
                padding: var(--spacing-sm) var(--spacing-md);
            }
            .tabs {
                flex-direction: column;
            }
            .tab {
                padding: var(--spacing-md) var(--spacing-lg);
                font-size: 0.95em;
            }
            .tab-content {
                padding: var(--spacing-lg) var(--spacing-md);
            }
            .section {
                padding: var(--spacing-md);
                margin-bottom: var(--spacing-lg);
            }
            .section-title {
                font-size: 1.25em;
                margin-bottom: var(--spacing-sm);
            }
            table {
                font-size: 0.9em;
                min-width: 600px;
            }
            th, td {
                padding: var(--spacing-sm);
            }
            input[type="text"] {
                padding: var(--spacing-sm);
                font-size: 0.9em;
                min-height: 36px;
            }
            input[type="number"] {
                padding: var(--spacing-sm);
                font-size: 0.9em;
                min-height: 36px;
                max-width: 120px;
            }
            .btn {
                padding: var(--spacing-sm) var(--spacing-md);
                font-size: 0.85em;
            }
            .btn-export {
                padding: var(--spacing-md) var(--spacing-lg);
                font-size: 0.95em;
                width: 100%;
            }
            .status-indicator {
                padding: var(--spacing-lg) var(--spacing-md);
                font-size: 1.1em;
            }
            .table-wrapper {
                margin: 0 calc(var(--spacing-md) * -1);
            }
        }

        @media (max-width: 640px) {
            :root {
                --spacing-xs: 3px;
                --spacing-sm: 6px;
                --spacing-md: 10px;
                --spacing-lg: 14px;
                --spacing-xl: 20px;
            }
            .header h1 {
                font-size: 1.6em;
            }
            .header p {
                font-size: 0.9em;
            }
            .section-title {
                font-size: 1.15em;
            }
            table {
                font-size: 0.85em;
                min-width: 550px;
            }
            input[type="number"] {
                max-width: 110px;
            }
        }

        @media (max-width: 480px) {
            :root {
                --spacing-xs: 3px;
                --spacing-sm: 5px;
                --spacing-md: 8px;
                --spacing-lg: 12px;
                --spacing-xl: 16px;
            }
            body {
                padding: var(--spacing-xs);
            }
            .container {
                border-radius: 0;
                border-left: none;
                border-right: none;
            }
            .header {
                padding: var(--spacing-md) var(--spacing-sm);
            }
            .header h1 {
                font-size: 1.4em;
            }
            .header p {
                font-size: 0.85em;
            }
            .theme-toggle {
                padding: var(--spacing-sm) var(--spacing-md);
                font-size: 0.8em;
                margin-bottom: var(--spacing-sm);
            }
            .tab {
                padding: var(--spacing-sm) var(--spacing-md);
                font-size: 0.9em;
            }
            .tab-content {
                padding: var(--spacing-md) var(--spacing-sm);
            }
            .section {
                padding: var(--spacing-sm);
                margin-bottom: var(--spacing-md);
            }
            .section-title {
                font-size: 1.05em;
                padding-bottom: var(--spacing-xs);
                margin-bottom: var(--spacing-sm);
            }
            table {
                font-size: 0.8em;
                min-width: 500px;
            }
            th {
                font-size: 0.75em;
                padding: var(--spacing-sm);
            }
            th, td {
                padding: var(--spacing-xs) var(--spacing-xs);
            }
            input[type="text"] {
                padding: var(--spacing-xs) var(--spacing-sm);
                font-size: 0.85em;
                min-height: 32px;
            }
            input[type="number"] {
                padding: var(--spacing-xs) var(--spacing-sm);
                font-size: 0.85em;
                min-height: 32px;
                max-width: 100px;
            }
            .btn {
                padding: var(--spacing-xs) var(--spacing-sm);
                font-size: 0.8em;
            }
            .btn-add {
                margin: var(--spacing-xs);
            }
            .btn-export {
                padding: var(--spacing-sm) var(--spacing-md);
                font-size: 0.9em;
            }
            .status-indicator {
                padding: var(--spacing-md) var(--spacing-sm);
                font-size: 1em;
            }
            #status-score {
                font-size: 1.6em !important;
                margin-top: var(--spacing-xs) !important;
            }
            .category-row td {
                padding: var(--spacing-sm);
                font-size: 0.9em;
            }
            .subtotal-row td, .total-row td, .grand-total-row td {
                padding: var(--spacing-sm);
            }
            .table-wrapper {
                margin: 0 calc(var(--spacing-sm) * -1);
            }
        }

        @media (max-width: 360px) {
            .header h1 {
                font-size: 1.2em;
            }
            .header p {
                font-size: 0.8em;
            }
            .tab {
                padding: var(--spacing-xs) var(--spacing-sm);
                font-size: 0.85em;
            }
            .section-title {
                font-size: 1em;
            }
            table {
                font-size: 0.75em;
                min-width: 450px;
            }
            th, td {
                padding: var(--spacing-xs);
            }
            input[type="text"] {
                padding: var(--spacing-xs);
                font-size: 0.8em;
                min-height: 30px;
            }
            input[type="number"] {
                padding: var(--spacing-xs);
                font-size: 0.8em;
                min-height: 30px;
                max-width: 90px;
            }
            .btn {
                padding: var(--spacing-xs);
                font-size: 0.75em;
            }
            .status-indicator {
                font-size: 0.95em;
            }
        }

        @media (max-width: 768px) {
            .category-row td:first-child {
                position: sticky;
                right: 0;
                background: var(--bg-tertiary);
                z-index: 1;
            }
            .table-wrapper {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }
        }

    </style>
</head>
<body>
    <!-- Loading overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <div class="loading-text">Ø¬Ø§Ø±Ù Ø§Ù„ØªÙ‚Ø§Ø· Ø§Ù„ØµÙˆØ±Ø©...</div>
            <div class="loading-subtext">Ù‚Ø¯ ÙŠØ³ØªØºØ±Ù‚ Ù‡Ø°Ø§ Ø¨Ø¶Ø¹ Ø«ÙˆØ§Ù†Ù</div>
        </div>
    </div>

    <div class="container">
        <div class="header">
            <button class="theme-toggle" onclick="toggleTheme()">ğŸŒ™ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ</button>
            <h1>ğŸ’°Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨Ø³ÙŠØ·</h1>
            <p>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© ÙˆØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('income')">Ù…ØµØ§Ø¯Ø± Ø§Ù„Ø¯Ø®Ù„</button>
            <button class="tab" onclick="switchTab('expenses')">Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©</button>
            <button class="tab" onclick="switchTab('analysis')">ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…ÙˆÙ‚Ù</button>
        </div>

        <!-- Ù‚Ø³Ù… Ù…ØµØ§Ø¯Ø± Ø§Ù„Ø¯Ø®Ù„ -->
        <div id="income" class="tab-content active">
            <h2 class="section-title">ğŸ“Š ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¯Ø®Ù„</h2>
            
            <table id="incomeTable">
                <thead>
                    <tr>
                        <th style="width: 8%">Ù…</th>
                        <th style="width: 25%">Ù†ÙˆØ¹ Ø§Ù„Ø¯Ø®Ù„</th>
                        <th style="width: 35%">Ù…ØµØ¯Ø± Ø§Ù„Ø¯Ø®Ù„</th>
                        <th style="width: 22%">Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø´Ù‡Ø±ÙŠ</th>
                        <th style="width: 10%">Ø¥Ø¬Ø±Ø§Ø¡</th>
                    </tr>
                </thead>
                <tbody id="incomeBody">
                    <!-- Ø§Ù„Ø±ÙˆØ§ØªØ¨ ÙˆØ§Ù„Ø¨Ø¯Ù„Ø§Øª -->
                    <tr class="category-row">
                        <td>1</td>
                        <td colspan="5"><strong>Ø§Ù„Ø±ÙˆØ§ØªØ¨ ÙˆØ§Ù„Ø¨Ø¯Ù„Ø§Øª</strong></td>
                    </tr>
                    <tr data-category="salaries">
                        <td></td>
                        <td></td>
                        <td><input type="text" placeholder="Ù…ØµØ¯Ø± Ø§Ù„Ø¯Ø®Ù„"></td>
                        <td><input type="number" class="income-amount" data-category="salaries" value="0" onchange="calculateIncome()"></td>
                        <td><button class="btn btn-remove" onclick="removeIncomeRow(this)">Ø­Ø°Ù</button></td>
                    </tr>
                    <tr>
                        <td colspan="2"></td>
                        <td><button class="btn btn-add" onclick="addIncomeRow('salaries')">+ Ø¥Ø¶Ø§ÙØ© Ù…ØµØ¯Ø±</button></td>
                        <td colspan="2"></td>
                    </tr>
                    <tr class="subtotal-row">
                        <td></td>
                        <td colspan="2"><strong>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</strong></td>
                        <td><strong id="salaries-total">0</strong></td>
                        <td></td>
                    </tr>

                    <!-- Ø§Ù„Ø¥Ø¹Ø§Ù†Ø§Øª -->
                    <tr class="category-row">
                        <td>2</td>
                        <td colspan="5"><strong>Ø§Ù„Ø¥Ø¹Ø§Ù†Ø§Øª</strong></td>
                    </tr>
                    <tr data-category="allowances">
                        <td></td>
                        <td></td>
                        <td><input type="text" placeholder="Ù…ØµØ¯Ø± Ø§Ù„Ø¯Ø®Ù„"></td>
                        <td><input type="number" class="income-amount" data-category="allowances" value="0" onchange="calculateIncome()"></td>
                        <td><button class="btn btn-remove" onclick="removeIncomeRow(this)">Ø­Ø°Ù</button></td>
                    </tr>
                    <tr>
                        <td colspan="2"></td>
                        <td><button class="btn btn-add" onclick="addIncomeRow('allowances')">+ Ø¥Ø¶Ø§ÙØ© Ù…ØµØ¯Ø±</button></td>
                        <td colspan="2"></td>
                    </tr>
                    <tr class="subtotal-row">
                        <td></td>
                        <td colspan="2"><strong>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</strong></td>
                        <td><strong id="allowances-total">0</strong></td>
                        <td></td>
                    </tr>

                    <!-- Ø§Ø³ØªØ«Ù…Ø§Ø±Ø§Øª -->
                    <tr class="category-row">
                        <td>3</td>
                        <td colspan="5"><strong>Ø§Ø³ØªØ«Ù…Ø§Ø±Ø§Øª / Ù…Ø´Ø§Ø±ÙŠØ¹ / Ø£Ø¹Ù…Ø§Ù„ Ø¥Ø¶Ø§ÙÙŠØ©</strong></td>
                    </tr>
                    <tr data-category="investments">
                        <td></td>
                        <td></td>
                        <td><input type="text" placeholder="Ù…ØµØ¯Ø± Ø§Ù„Ø¯Ø®Ù„"></td>
                        <td><input type="number" class="income-amount" data-category="investments" value="0" onchange="calculateIncome()"></td>
                        <td><button class="btn btn-remove" onclick="removeIncomeRow(this)">Ø­Ø°Ù</button></td>
                    </tr>
                    <tr>
                        <td colspan="2"></td>
                        <td><button class="btn btn-add" onclick="addIncomeRow('investments')">+ Ø¥Ø¶Ø§ÙØ© Ù…ØµØ¯Ø±</button></td>
                        <td colspan="2"></td>
                    </tr>
                    <tr class="subtotal-row">
                        <td></td>
                        <td colspan="2"><strong>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</strong></td>
                        <td><strong id="investments-total">0</strong></td>
                        <td></td>
                    </tr>

                    <!-- Ù…Ø³Ø§Ù‡Ù…Ø§Øª Ø£Ø®Ø±Ù‰ -->
                    <tr class="category-row">
                        <td>4</td>
                        <td colspan="5"><strong>Ù…Ø³Ø§Ù‡Ù…Ø§Øª Ø£Ø®Ø±Ù‰</strong></td>
                    </tr>
                    <tr data-category="others">
                        <td></td>
                        <td></td>
                        <td><input type="text" placeholder="Ù…ØµØ¯Ø± Ø§Ù„Ø¯Ø®Ù„"></td>
                        <td><input type="number" class="income-amount" data-category="others" value="0" onchange="calculateIncome()"></td>
                        <td><button class="btn btn-remove" onclick="removeIncomeRow(this)">Ø­Ø°Ù</button></td>
                    </tr>
                    <tr>
                        <td colspan="2"></td>
                        <td><button class="btn btn-add" onclick="addIncomeRow('others')">+ Ø¥Ø¶Ø§ÙØ© Ù…ØµØ¯Ø±</button></td>
                        <td colspan="2"></td>
                    </tr>
                    <tr class="subtotal-row">
                        <td></td>
                        <td colspan="2"><strong>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</strong></td>
                        <td><strong id="others-total">0</strong></td>
                        <td></td>
                    </tr>

                    <!-- Ø§Ù„Ù…Ø¬Ø§Ù…ÙŠØ¹ -->
                    <tr class="total-row">
                        <td></td>
                        <td colspan="2"><strong>Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø¯Ø®Ù„ Ø´Ù‡Ø±ÙŠØ§Ù‹</strong></td>
                        <td><strong id="monthly-income">0</strong></td>
                        <td></td>
                    </tr>
                    <tr class="grand-total-row">
                        <td></td>
                        <td colspan="2"><strong>Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø¯Ø®Ù„ Ø³Ù†ÙˆÙŠØ§Ù‹</strong></td>
                        <td><strong id="yearly-income">0</strong></td>
                        <td></td>
                    </tr>
                    <tr class="total-row">
                        <td></td>
                        <td colspan="2"><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ (Ù…Ù† Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ)</strong></td>
                        <td><strong id="total-expenses-display">0</strong></td>
                        <td></td>
                    </tr>
                    <tr class="grand-total-row">
                        <td></td>
                        <td colspan="2"><strong>ØµØ§ÙÙŠ Ø§Ù„ÙØ§Ø¦Ø¶</strong></td>
                        <td><strong id="net-surplus">0</strong></td>
                        <td></td>
                    </tr>
                </tbody>
            </table>

            <button class="btn btn-export" onclick="exportToPDF('income')">ğŸ“¸ Ø­ÙØ¸ ØµÙˆØ±Ø© Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¯Ø®Ù„</button>
        </div>

        <!-- Ù‚Ø³Ù… Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ -->
        <div id="expenses" class="tab-content">
            <h2 class="section-title">ğŸ’³ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ </h2>
            
            <table id="expensesTable">
                <thead>
                    <tr>
                        <th style="width: 8%">#</th>
                        <th style="width: 25%">Ù†ÙˆØ¹ Ø§Ù„Ù…ØµØ±ÙˆÙ</th>
                        <th style="width: 35%">Ø¨ÙŠØ§Ù† Ø§Ù„Ù…ØµØ±ÙˆÙ</th>
                        <th style="width: 22%">Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø´Ù‡Ø±ÙŠ</th>
                        <th style="width: 10%">Ø¥Ø¬Ø±Ø§Ø¡</th>
                    </tr>
                </thead>
                <tbody id="expensesBody">
                    <!-- Ø§Ù„Ù…ÙˆØ§ØµÙ„Ø§Øª -->
                    <tr class="category-row">
                        <td>1</td>
                        <td colspan="5"><strong>Ø§Ù„Ù…ÙˆØ§ØµÙ„Ø§Øª / Ø§Ù„Ø¨Ù†Ø²ÙŠÙ†</strong></td>
                    </tr>
                    <tr data-category="transport">
                        <td></td>
                        <td></td>
                        <td><input type="text" placeholder="Ø¨ÙŠØ§Ù† Ø§Ù„Ù…ØµØ±ÙˆÙ"></td>
                        <td><input type="number" class="expense-amount" data-category="transport" value="0" onchange="calculateExpenses()"></td>
                        <td><button class="btn btn-remove" onclick="removeExpenseRow(this)">Ø­Ø°Ù</button></td>
                    </tr>
                    <tr>
                        <td colspan="2"></td>
                        <td><button class="btn btn-add" onclick="addExpenseRow('transport')">+ Ø¥Ø¶Ø§ÙØ© Ø¨Ù†Ø¯</button></td>
                        <td colspan="2"></td>
                    </tr>
                    <tr class="subtotal-row">
                        <td></td>
                        <td colspan="2"><strong>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</strong></td>
                        <td><strong id="transport-total">0</strong></td>
                        <td></td>
                    </tr>

                    <!-- Ø§Ù„Ø¨ÙŠØª -->
                    <tr class="category-row">
                        <td>2</td>
                        <td colspan="5"><strong>Ø§Ù„Ø¨ÙŠØª / Ø§Ù„Ø¥ÙŠØ¬Ø§Ø±</strong></td>
                    </tr>
                    <tr data-category="housing">
                        <td></td>
                        <td></td>
                        <td><input type="text" placeholder="Ø¨ÙŠØ§Ù† Ø§Ù„Ù…ØµØ±ÙˆÙ"></td>
                        <td><input type="number" class="expense-amount" data-category="housing" value="0" onchange="calculateExpenses()"></td>
                        <td><button class="btn btn-remove" onclick="removeExpenseRow(this)">Ø­Ø°Ù</button></td>
                    </tr>
                    <tr>
                        <td colspan="2"></td>
                        <td><button class="btn btn-add" onclick="addExpenseRow('housing')">+ Ø¥Ø¶Ø§ÙØ© Ø¨Ù†Ø¯</button></td>
                        <td colspan="2"></td>
                    </tr>
                    <tr class="subtotal-row">
                        <td></td>
                        <td colspan="2"><strong>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</strong></td>
                        <td><strong id="housing-total">0</strong></td>
                        <td></td>
                    </tr>

                    <!-- Ø§Ù„Ù…Ù‚Ø§Ø¶ÙŠ -->
                    <tr class="category-row">
                        <td>3</td>
                        <td colspan="5"><strong>Ø§Ù„Ù…Ù‚Ø§Ø¶ÙŠ</strong></td>
                    </tr>
                    <tr data-category="groceries">
                        <td></td>
                        <td></td>
                        <td><input type="text" placeholder="Ø¨ÙŠØ§Ù† Ø§Ù„Ù…ØµØ±ÙˆÙ"></td>
                        <td><input type="number" class="expense-amount" data-category="groceries" value="0" onchange="calculateExpenses()"></td>
                        <td><button class="btn btn-remove" onclick="removeExpenseRow(this)">Ø­Ø°Ù</button></td>
                    </tr>
                    <tr>
                        <td colspan="2"></td>
                        <td><button class="btn btn-add" onclick="addExpenseRow('groceries')">+ Ø¥Ø¶Ø§ÙØ© Ø¨Ù†Ø¯</button></td>
                        <td colspan="2"></td>
                    </tr>
                    <tr class="subtotal-row">
                        <td></td>
                        <td colspan="2"><strong>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</strong></td>
                        <td><strong id="groceries-total">0</strong></td>
                        <td></td>
                    </tr>

                    <!-- Ø§Ù„ØµÙŠØ§Ù†Ø© -->
                    <tr class="category-row">
                        <td>4</td>
                        <td colspan="5"><strong>Ù…ØµØ§Ø±ÙŠÙ ØµÙŠØ§Ù†Ø© / Ø§Ø³ØªØ¨Ø¯Ø§Ù„</strong></td>
                    </tr>
                    <tr data-category="maintenance">
                        <td></td>
                        <td></td>
                        <td><input type="text" placeholder="Ø¨ÙŠØ§Ù† Ø§Ù„Ù…ØµØ±ÙˆÙ"></td>
                        <td><input type="number" class="expense-amount" data-category="maintenance" value="0" onchange="calculateExpenses()"></td>
                        <td><button class="btn btn-remove" onclick="removeExpenseRow(this)">Ø­Ø°Ù</button></td>
                    </tr>
                    <tr>
                        <td colspan="2"></td>
                        <td><button class="btn btn-add" onclick="addExpenseRow('maintenance')">+ Ø¥Ø¶Ø§ÙØ© Ø¨Ù†Ø¯</button></td>
                        <td colspan="2"></td>
                    </tr>
                    <tr class="subtotal-row">
                        <td></td>
                        <td colspan="2"><strong>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</strong></td>
                        <td><strong id="maintenance-total">0</strong></td>
                        <td></td>
                    </tr>

                    <!-- Ø§Ù„ØªØ±ÙÙŠÙ‡ -->
                    <tr class="category-row">
                        <td>5</td>
                        <td colspan="5"><strong>Ø§Ù„ØªØ±ÙÙŠÙ‡</strong></td>
                    </tr>
                    <tr data-category="entertainment">
                        <td></td>
                        <td></td>
                        <td><input type="text" placeholder="Ø¨ÙŠØ§Ù† Ø§Ù„Ù…ØµØ±ÙˆÙ"></td>
                        <td><input type="number" class="expense-amount" data-category="entertainment" value="0" onchange="calculateExpenses()"></td>
                        <td><button class="btn btn-remove" onclick="removeExpenseRow(this)">Ø­Ø°Ù</button></td>
                    </tr>
                    <tr>
                        <td colspan="2"></td>
                        <td><button class="btn btn-add" onclick="addExpenseRow('entertainment')">+ Ø¥Ø¶Ø§ÙØ© Ø¨Ù†Ø¯</button></td>
                        <td colspan="2"></td>
                    </tr>
                    <tr class="subtotal-row">
                        <td></td>
                        <td colspan="2"><strong>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</strong></td>
                        <td><strong id="entertainment-total">0</strong></td>
                        <td></td>
                    </tr>

                    <!-- Ø§Ù„ØµØ­Ø© -->
                    <tr class="category-row">
                        <td>6</td>
                        <td colspan="5"><strong>Ø§Ù„ØµØ­Ø©</strong></td>
                    </tr>
                    <tr data-category="health">
                        <td></td>
                        <td></td>
                        <td><input type="text" placeholder="Ø¨ÙŠØ§Ù† Ø§Ù„Ù…ØµØ±ÙˆÙ"></td>
                        <td><input type="number" class="expense-amount" data-category="health" value="0" onchange="calculateExpenses()"></td>
                        <td><button class="btn btn-remove" onclick="removeExpenseRow(this)">Ø­Ø°Ù</button></td>
                    </tr>
                    <tr>
                        <td colspan="2"></td>
                        <td><button class="btn btn-add" onclick="addExpenseRow('health')">+ Ø¥Ø¶Ø§ÙØ© Ø¨Ù†Ø¯</button></td>
                        <td colspan="2"></td>
                    </tr>
                    <tr class="subtotal-row">
                        <td></td>
                        <td colspan="2"><strong>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</strong></td>
                        <td><strong id="health-total">0</strong></td>
                        <td></td>
                    </tr>

                    <!-- Ø§Ù„ØªØ¹Ù„ÙŠÙ… -->
                    <tr class="category-row">
                        <td>7</td>
                        <td colspan="5"><strong>Ø§Ù„ØªØ¹Ù„ÙŠÙ…</strong></td>
                    </tr>
                    <tr data-category="education">
                        <td></td>
                        <td></td>
                        <td><input type="text" placeholder="Ø¨ÙŠØ§Ù† Ø§Ù„Ù…ØµØ±ÙˆÙ"></td>
                        <td><input type="number" class="expense-amount" data-category="education" value="0" onchange="calculateExpenses()"></td>
                        <td><button class="btn btn-remove" onclick="removeExpenseRow(this)">Ø­Ø°Ù</button></td>
                    </tr>
                    <tr>
                        <td colspan="2"></td>
                        <td><button class="btn btn-add" onclick="addExpenseRow('education')">+ Ø¥Ø¶Ø§ÙØ© Ø¨Ù†Ø¯</button></td>
                        <td colspan="2"></td>
                    </tr>
                    <tr class="subtotal-row">
                        <td></td>
                        <td colspan="2"><strong>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</strong></td>
                        <td><strong id="education-total">0</strong></td>
                        <td></td>
                    </tr>

                    <!-- Ø§Ù„ØµØ¯Ù‚Ø§Øª -->
                    <tr class="category-row">
                        <td>8</td>
                        <td colspan="5"><strong>Ø§Ù„ØµØ¯Ù‚Ø§Øª / Ø§Ù„Ø²ÙƒØ§Ø© / Ø§Ù„Ù‡Ø¨Ø§Øª</strong></td>
                    </tr>
                    <tr data-category="charity">
                        <td></td>
                        <td></td>
                        <td><input type="text" placeholder="Ø¨ÙŠØ§Ù† Ø§Ù„Ù…ØµØ±ÙˆÙ"></td>
                        <td><input type="number" class="expense-amount" data-category="charity" value="0" onchange="calculateExpenses()"></td>
                        <td><button class="btn btn-remove" onclick="removeExpenseRow(this)">Ø­Ø°Ù</button></td>
                    </tr>
                    <tr>
                        <td colspan="2"></td>
                        <td><button class="btn btn-add" onclick="addExpenseRow('charity')">+ Ø¥Ø¶Ø§ÙØ© Ø¨Ù†Ø¯</button></td>
                        <td colspan="2"></td>
                    </tr>
                    <tr class="subtotal-row">
                        <td></td>
                        <td colspan="2"><strong>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</strong></td>
                        <td><strong id="charity-total">0</strong></td>
                        <td></td>
                    </tr>

                    <!-- Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª -->
                    <tr class="category-row">
                        <td>9</td>
                        <td colspan="5"><strong>Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª / Ø§Ù„Ø¯ÙŠÙˆÙ†</strong></td>
                    </tr>
                    <tr data-category="debts">
                        <td></td>
                        <td></td>
                        <td><input type="text" placeholder="Ø¨ÙŠØ§Ù† Ø§Ù„Ù…ØµØ±ÙˆÙ"></td>
                        <td><input type="number" class="expense-amount" data-category="debts" value="0" onchange="calculateExpenses()"></td>
                        <td><button class="btn btn-remove" onclick="removeExpenseRow(this)">Ø­Ø°Ù</button></td>
                    </tr>
                    <tr>
                        <td colspan="2"></td>
                        <td><button class="btn btn-add" onclick="addExpenseRow('debts')">+ Ø¥Ø¶Ø§ÙØ© Ø¨Ù†Ø¯</button></td>
                        <td colspan="2"></td>
                    </tr>
                    <tr class="subtotal-row">
                        <td></td>
                        <td colspan="2"><strong>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</strong></td>
                        <td><strong id="debts-total">0</strong></td>
                        <td></td>
                    </tr>

                    <!-- Ø§Ù„Ø§Ø¯Ø®Ø§Ø± -->
                    <tr class="category-row">
                        <td>10</td>
                        <td colspan="5"><strong>Ø§Ø¯Ø®Ø§Ø± / Ø·ÙˆØ§Ø±Ø¦</strong></td>
                    </tr>
                    <tr data-category="savings">
                        <td></td>
                        <td></td>
                        <td><input type="text" placeholder="Ø¨ÙŠØ§Ù† Ø§Ù„Ù…ØµØ±ÙˆÙ"></td>
                        <td><input type="number" class="expense-amount" data-category="savings" value="0" onchange="calculateExpenses()"></td>
                        <td><button class="btn btn-remove" onclick="removeExpenseRow(this)">Ø­Ø°Ù</button></td>
                    </tr>
                    <tr>
                        <td colspan="2"></td>
                        <td><button class="btn btn-add" onclick="addExpenseRow('savings')">+ Ø¥Ø¶Ø§ÙØ© Ø¨Ù†Ø¯</button></td>
                        <td colspan="2"></td>
                    </tr>
                    <tr class="subtotal-row">
                        <td></td>
                        <td colspan="2"><strong>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</strong></td>
                        <td><strong id="savings-total">0</strong></td>
                        <td></td>
                    </tr>

                    <!-- Ø§Ù„Ù…Ø¬Ø§Ù…ÙŠØ¹ -->
                    <tr class="total-row">
                        <td></td>
                        <td colspan="2"><strong>Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ Ø´Ù‡Ø±ÙŠØ§Ù‹</strong></td>
                        <td><strong id="monthly-expenses">0</strong></td>
                        <td></td>
                    </tr>
                    <tr class="grand-total-row">
                        <td></td>
                        <td colspan="2"><strong>Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ Ø³Ù†ÙˆÙŠØ§Ù‹</strong></td>
                        <td><strong id="yearly-expenses">0</strong></td>
                        <td></td>
                    </tr>
                </tbody>
            </table>

            <button class="btn btn-export" onclick="exportToPDF('expenses')">ğŸ“¸ Ø­ÙØ¸ ØµÙˆØ±Ø© Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ</button>
        </div>

        <!-- Ù‚Ø³Ù… Ø§Ù„ØªØ­Ù„ÙŠÙ„ -->
        <div id="analysis" class="tab-content">
            <h2 class="section-title">ğŸ“ˆ Ø§Ù„ØªØ­Ù„ÙŠÙ„</h2>
            
            <div id="status-display" class="status-indicator">
                <div id="status-text">Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªØ­Ù„ÙŠÙ„</div>
                <div id="status-score" style="font-size: 2em; margin-top: 10px;"></div>
            </div>

            <table class="analysis-table">
                <thead>
                    <tr>
                        <th>Ø§Ù„Ù†ØªÙŠØ¬Ø©</th>
                        <th>Ø§Ù„Ù…ÙˆÙ‚Ù</th>
                        <th>Ø§Ù„ØªØ·ÙˆÙŠØ± Ø§Ù„Ù…Ù‚ØªØ±Ø­</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="positive">+5</td>
                        <td>Ù…Ù…ØªØ§Ø² Ø¬Ø¯Ø§Ù‹</td>
                        <td>Ø§Ø³ØªÙ…Ø± ÙÙŠ Ù†ÙØ³ Ø§Ù„Ù†Ù‡Ø¬ ÙˆØ²Ø¯ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±Ø§Øª</td>
                    </tr>
                    <tr>
                        <td class="positive">+4</td>
                        <td>Ù…Ù…ØªØ§Ø²</td>
                        <td>ÙˆØ¶Ø¹ Ù…Ù…ØªØ§Ø²ØŒ ÙÙƒØ± ÙÙŠ ÙØ±Øµ Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©</td>
                    </tr>
                    <tr>
                        <td class="positive">+3</td>
                        <td>Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹</td>
                        <td>Ø­Ø§ÙØ¸ Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ ÙˆØ±Ø§Ø¬Ø¹ Ø®Ø·Ø© Ø§Ù„Ø§Ø¯Ø®Ø§Ø±</td>
                    </tr>
                    <tr>
                        <td class="positive">+2</td>
                        <td>Ø¬ÙŠØ¯</td>
                        <td>Ø­Ø§ÙˆÙ„ Ø²ÙŠØ§Ø¯Ø© Ø§Ù„ÙØ§Ø¦Ø¶ Ù…Ù† Ø®Ù„Ø§Ù„ ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ ØºÙŠØ± Ø§Ù„Ø¶Ø±ÙˆØ±ÙŠØ©</td>
                    </tr>
                    <tr>
                        <td class="positive">+1</td>
                        <td>Ù…Ù†Ø§Ø³Ø¨</td>
                        <td>Ø§Ø¨Ø­Ø« Ø¹Ù† Ø·Ø±Ù‚ Ù„Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø¯Ø®Ù„ Ø£Ùˆ ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ</td>
                    </tr>
                    <tr>
                        <td class="neutral">0</td>
                        <td>Ù…ØªÙˆØ§Ø²Ù†</td>
                        <td>Ø§Ù„ÙˆØ¶Ø¹ Ù…ØªÙˆØ§Ø²Ù†ØŒ Ù„ÙƒÙ† ÙŠØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø¨Ù†Ø§Ø¡ Ø§Ø­ØªÙŠØ§Ø·ÙŠ Ù„Ù„Ø·ÙˆØ§Ø±Ø¦</td>
                    </tr>
                    <tr>
                        <td class="negative">-1</td>
                        <td>ØªØ±Ø§Ø¬Ø¹</td>
                        <td>Ø±Ø§Ø¬Ø¹ Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ ÙˆØ§Ø¨Ø­Ø« Ø¹Ù† Ù…ØµØ§Ø¯Ø± Ø¯Ø®Ù„ Ø¥Ø¶Ø§ÙÙŠØ©</td>
                    </tr>
                    <tr>
                        <td class="negative">-2</td>
                        <td>ØºÙŠØ± Ø¬ÙŠØ¯</td>
                        <td>Ù‚Ù„Ù„ Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ ØºÙŠØ± Ø§Ù„Ø¶Ø±ÙˆØ±ÙŠØ© ÙÙˆØ±Ø§Ù‹</td>
                    </tr>
                    <tr>
                        <td class="negative">-3</td>
                        <td>Ø³ÙŠØ¦</td>
                        <td>Ø£Ø¹Ø¯ Ù‡ÙŠÙƒÙ„Ø© Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© ÙˆÙ‚Ù„Ù„ Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ Ø¨Ø´ÙƒÙ„ ÙƒØ¨ÙŠØ±</td>
                    </tr>
                    <tr>
                        <td class="negative">-4</td>
                        <td>Ø³ÙŠØ¦ Ø¬Ø¯Ø§Ù‹</td>
                        <td>ØªØ¯Ø®Ù„ Ø¹Ø§Ø¬Ù„ Ù…Ø·Ù„ÙˆØ¨ - Ø±Ø§Ø¬Ø¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª ÙˆØ§Ù„Ø¯ÙŠÙˆÙ†</td>
                    </tr>
                    <tr>
                        <td class="negative">-5</td>
                        <td>ÙŠØ­ØªØ§Ø¬ ØªØ¯Ø®Ù„ Ø¹Ø§Ø¬Ù„</td>
                        <td>Ø§Ø³ØªØ´Ø± Ù…Ø³ØªØ´Ø§Ø± Ù…Ø§Ù„ÙŠ ÙÙˆØ±Ø§Ù‹ ÙˆØ£Ø¹Ø¯ Ù‡ÙŠÙƒÙ„Ø© Ø§Ù„Ø¯ÙŠÙˆÙ†</td>
                    </tr>
                </tbody>
            </table>

            <button class="btn btn-export" onclick="exportToPDF('analysis')">ğŸ“¸ Ø­ÙØ¸ ØµÙˆØ±Ø© Ù„Ù„ØªØ­Ù„ÙŠÙ„</button>
        </div>
    </div>

    <script>
        

        // Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ ÙˆØ§Ù„Ù†Ù‡Ø§Ø±ÙŠ
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            const themeButton = document.querySelector('.theme-toggle');
            
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            
            if (newTheme === 'dark') {
                themeButton.innerHTML = 'â˜€ï¸ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù†Ù‡Ø§Ø±ÙŠ';
            } else {
                themeButton.innerHTML = 'ğŸŒ™ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ';
            }
        }

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø«ÙŠÙ… Ø§Ù„Ù…Ø­ÙÙˆØ¸
        function loadTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            const themeButton = document.querySelector('.theme-toggle');
            document.documentElement.setAttribute('data-theme', savedTheme);
            
            if (savedTheme === 'dark') {
                themeButton.innerHTML = 'â˜€ï¸ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù†Ù‡Ø§Ø±ÙŠ';
            }
        }

        // Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
        function switchTab(tabName) {
            const tabs = document.querySelectorAll('.tab');
            const contents = document.querySelectorAll('.tab-content');
            
            tabs.forEach(tab => tab.classList.remove('active'));
            contents.forEach(content => content.classList.remove('active'));
            
            // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ§Ø¨ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨
            const activeTab = Array.from(tabs).find(tab => {
                const tabText = tab.textContent.trim();
                return (tabName === 'income' && tabText.includes('Ù…ØµØ§Ø¯Ø± Ø§Ù„Ø¯Ø®Ù„')) ||
                       (tabName === 'expenses' && tabText.includes('Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©')) ||
                       (tabName === 'analysis' && tabText.includes('ØªØ­Ù„ÙŠÙ„ Ù…ÙˆÙ‚Ù'));
            });
            
            if (activeTab) activeTab.classList.add('active');
            
            const content = document.getElementById(tabName);
            if (content) content.classList.add('active');
            
            if (tabName === 'analysis') {
                updateAnalysis();
            }
        }

        // Ø¥Ø¶Ø§ÙØ© ØµÙ Ø¯Ø®Ù„ Ø¬Ø¯ÙŠØ¯
        function addIncomeRow(category) {
            const tbody = document.getElementById('incomeBody');
            const newRow = document.createElement('tr');
            newRow.setAttribute('data-category', category);
            newRow.innerHTML = `
                <td></td>
                <td></td>
                <td><input type="text" placeholder="Ù…ØµØ¯Ø± Ø§Ù„Ø¯Ø®Ù„"></td>
                <td><input type="number" class="income-amount" data-category="${category}" value="0" onchange="calculateIncome()"></td>
                <td><button class="btn btn-remove" onclick="removeIncomeRow(this)">Ø­Ø°Ù</button></td>
            `;
            
            const allRows = Array.from(tbody.querySelectorAll('tr'));
            let addButtonRow = null;
            let foundCategory = false;
            
            for (let i = 0; i < allRows.length; i++) {
                const row = allRows[i];
                if (row.classList.contains('category-row') && row.textContent.includes(getCategoryName(category))) {
                    foundCategory = true;
                    continue;
                }
                if (foundCategory && row.querySelector('.btn-add')) {
                    addButtonRow = row;
                    break;
                }
            }
            
            if (addButtonRow) {
                tbody.insertBefore(newRow, addButtonRow);
            }
        }

        function getCategoryName(category) {
            const names = {
                'salaries': 'Ø§Ù„Ø±ÙˆØ§ØªØ¨ ÙˆØ§Ù„Ø¨Ø¯Ù„Ø§Øª',
                'allowances': 'Ø§Ù„Ø¥Ø¹Ø§Ù†Ø§Øª',
                'investments': 'Ø§Ø³ØªØ«Ù…Ø§Ø±Ø§Øª',
                'others': 'Ù…Ø³Ø§Ù‡Ù…Ø§Øª Ø£Ø®Ø±Ù‰'
            };
            return names[category] || '';
        }

        function removeIncomeRow(btn) {
            btn.closest('tr').remove();
            calculateIncome();
        }

        function addExpenseRow(category) {
            const tbody = document.getElementById('expensesBody');
            const newRow = document.createElement('tr');
            newRow.setAttribute('data-category', category);
            newRow.innerHTML = `
                <td></td>
                <td></td>
                <td><input type="text" placeholder="Ø¨ÙŠØ§Ù† Ø§Ù„Ù…ØµØ±ÙˆÙ"></td>
                <td><input type="number" class="expense-amount" data-category="${category}" value="0" onchange="calculateExpenses()"></td>
                <td><button class="btn btn-remove" onclick="removeExpenseRow(this)">Ø­Ø°Ù</button></td>
            `;
            
            const allRows = Array.from(tbody.querySelectorAll('tr'));
            let addButtonRow = null;
            let foundCategory = false;
            
            for (let i = 0; i < allRows.length; i++) {
                const row = allRows[i];
                if (row.classList.contains('category-row') && row.textContent.includes(getExpenseCategoryName(category))) {
                    foundCategory = true;
                    continue;
                }
                if (foundCategory && row.querySelector('.btn-add')) {
                    addButtonRow = row;
                    break;
                }
            }
            
            if (addButtonRow) {
                tbody.insertBefore(newRow, addButtonRow);
            }
        }

        function getExpenseCategoryName(category) {
            const names = {
                'transport': 'Ø§Ù„Ù…ÙˆØ§ØµÙ„Ø§Øª',
                'housing': 'Ø§Ù„Ø¨ÙŠØª',
                'groceries': 'Ø§Ù„Ù…Ù‚Ø§Ø¶ÙŠ',
                'maintenance': 'ØµÙŠØ§Ù†Ø©',
                'entertainment': 'Ø§Ù„ØªØ±ÙÙŠÙ‡',
                'health': 'Ø§Ù„ØµØ­Ø©',
                'education': 'Ø§Ù„ØªØ¹Ù„ÙŠÙ…',
                'charity': 'Ø§Ù„ØµØ¯Ù‚Ø§Øª',
                'debts': 'Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª',
                'savings': 'Ø§Ø¯Ø®Ø§Ø±'
            };
            return names[category] || '';
        }

        function removeExpenseRow(btn) {
            btn.closest('tr').remove();
            calculateExpenses();
        }

        function calculateIncome() {
            const categories = ['salaries', 'allowances', 'investments', 'others'];
            let totalMonthly = 0;

            categories.forEach(category => {
                const inputs = document.querySelectorAll(`.income-amount[data-category="${category}"]`);
                let categoryTotal = 0;
                
                inputs.forEach(input => {
                    categoryTotal += parseFloat(input.value) || 0;
                });
                
                document.getElementById(`${category}-total`).textContent = categoryTotal.toLocaleString();
                totalMonthly += categoryTotal;
            });

            document.getElementById('monthly-income').textContent = totalMonthly.toLocaleString();
            document.getElementById('yearly-income').textContent = (totalMonthly * 12).toLocaleString();
            
            calculateNetSurplus();
        }

        function calculateExpenses() {
            const categories = ['transport', 'housing', 'groceries', 'maintenance', 'entertainment', 
                              'health', 'education', 'charity', 'debts', 'savings'];
            let totalMonthly = 0;

            categories.forEach(category => {
                const inputs = document.querySelectorAll(`.expense-amount[data-category="${category}"]`);
                let categoryTotal = 0;
                
                inputs.forEach(input => {
                    categoryTotal += parseFloat(input.value) || 0;
                });
                
                document.getElementById(`${category}-total`).textContent = categoryTotal.toLocaleString();
                totalMonthly += categoryTotal;
            });

            document.getElementById('monthly-expenses').textContent = totalMonthly.toLocaleString();
            document.getElementById('yearly-expenses').textContent = (totalMonthly * 12).toLocaleString();
            
            calculateNetSurplus();
        }

        function calculateNetSurplus() {
            const yearlyIncome = parseFloat(document.getElementById('yearly-income').textContent.replace(/,/g, '')) || 0;
            const yearlyExpenses = parseFloat(document.getElementById('yearly-expenses').textContent.replace(/,/g, '')) || 0;
            const netSurplus = yearlyIncome - yearlyExpenses;
            
            document.getElementById('total-expenses-display').textContent = yearlyExpenses.toLocaleString();
            document.getElementById('net-surplus').textContent = netSurplus.toLocaleString();
            
            const surplusCell = document.getElementById('net-surplus').parentElement;
            surplusCell.style.color = netSurplus > 0 ? '#28a745' : netSurplus < 0 ? '#dc3545' : '#6c757d';
        }

        function updateAnalysis() {
            const yearlyIncome = parseFloat(document.getElementById('yearly-income').textContent.replace(/,/g, '')) || 0;
            const yearlyExpenses = parseFloat(document.getElementById('yearly-expenses').textContent.replace(/,/g, '')) || 0;
            
            if (yearlyIncome === 0 && yearlyExpenses === 0) {
                document.getElementById('status-text').textContent = 'Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®Ù„ ÙˆØ§Ù„Ù…ØµØ§Ø±ÙŠÙ Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªØ­Ù„ÙŠÙ„';
                document.getElementById('status-score').textContent = '';
                document.getElementById('status-display').className = 'status-indicator';
                return;
            }
            
            const netSurplus = yearlyIncome - yearlyExpenses;
            const percentage = (netSurplus / yearlyIncome) * 100;
            
            const score = Math.round(percentage / 20);
            const clampedScore = Math.max(-5, Math.min(5, score));
            
            const statusMap = {
                5: { text: 'Ù…Ù…ØªØ§Ø² Ø¬Ø¯Ø§Ù‹', class: 'status-excellent', advice: 'Ø§Ø³ØªÙ…Ø± ÙÙŠ Ù†ÙØ³ Ø§Ù„Ù†Ù‡Ø¬ ÙˆØ²Ø¯ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±Ø§Øª' },
                4: { text: 'Ù…Ù…ØªØ§Ø²', class: 'status-excellent', advice: 'ÙˆØ¶Ø¹ Ù…Ù…ØªØ§Ø²ØŒ ÙÙƒØ± ÙÙŠ ÙØ±Øµ Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©' },
                3: { text: 'Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹', class: 'status-good', advice: 'Ø­Ø§ÙØ¸ Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ ÙˆØ±Ø§Ø¬Ø¹ Ø®Ø·Ø© Ø§Ù„Ø§Ø¯Ø®Ø§Ø±' },
                2: { text: 'Ø¬ÙŠØ¯', class: 'status-good', advice: 'Ø­Ø§ÙˆÙ„ Ø²ÙŠØ§Ø¯Ø© Ø§Ù„ÙØ§Ø¦Ø¶ Ù…Ù† Ø®Ù„Ø§Ù„ ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ ØºÙŠØ± Ø§Ù„Ø¶Ø±ÙˆØ±ÙŠØ©' },
                1: { text: 'Ù…Ù†Ø§Ø³Ø¨', class: 'status-good', advice: 'Ø§Ø¨Ø­Ø« Ø¹Ù† Ø·Ø±Ù‚ Ù„Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø¯Ø®Ù„ Ø£Ùˆ ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ' },
                0: { text: 'Ù…ØªÙˆØ§Ø²Ù†', class: 'status-balanced', advice: 'Ø§Ù„ÙˆØ¶Ø¹ Ù…ØªÙˆØ§Ø²Ù†ØŒ Ù„ÙƒÙ† ÙŠØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø¨Ù†Ø§Ø¡ Ø§Ø­ØªÙŠØ§Ø·ÙŠ Ù„Ù„Ø·ÙˆØ§Ø±Ø¦' },
                '-1': { text: 'ØªØ±Ø§Ø¬Ø¹', class: 'status-bad', advice: 'Ø±Ø§Ø¬Ø¹ Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ ÙˆØ§Ø¨Ø­Ø« Ø¹Ù† Ù…ØµØ§Ø¯Ø± Ø¯Ø®Ù„ Ø¥Ø¶Ø§ÙÙŠØ©' },
                '-2': { text: 'ØºÙŠØ± Ø¬ÙŠØ¯', class: 'status-bad', advice: 'Ù‚Ù„Ù„ Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ ØºÙŠØ± Ø§Ù„Ø¶Ø±ÙˆØ±ÙŠØ© ÙÙˆØ±Ø§Ù‹' },
                '-3': { text: 'Ø³ÙŠØ¦', class: 'status-bad', advice: 'Ø£Ø¹Ø¯ Ù‡ÙŠÙƒÙ„Ø© Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© ÙˆÙ‚Ù„Ù„ Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ Ø¨Ø´ÙƒÙ„ ÙƒØ¨ÙŠØ±' },
                '-4': { text: 'Ø³ÙŠØ¦ Ø¬Ø¯Ø§Ù‹', class: 'status-critical', advice: 'ØªØ¯Ø®Ù„ Ø¹Ø§Ø¬Ù„ Ù…Ø·Ù„ÙˆØ¨ - Ø±Ø§Ø¬Ø¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª ÙˆØ§Ù„Ø¯ÙŠÙˆÙ†' },
                '-5': { text: 'ÙŠØ­ØªØ§Ø¬ ØªØ¯Ø®Ù„ Ø¹Ø§Ø¬Ù„', class: 'status-critical', advice: 'Ø§Ø³ØªØ´Ø± Ù…Ø³ØªØ´Ø§Ø± Ù…Ø§Ù„ÙŠ ÙÙˆØ±Ø§Ù‹ ÙˆØ£Ø¹Ø¯ Ù‡ÙŠÙƒÙ„Ø© Ø§Ù„Ø¯ÙŠÙˆÙ†' }
            };
            
            const status = statusMap[clampedScore];
            document.getElementById('status-text').innerHTML = `
                <div style="font-size: 1.2em; margin-bottom: 10px;">Ù…ÙˆÙ‚Ù Ø§Ù„Ø£Ø³Ø±Ø©: ${status.text}</div>
                <div style="font-size: 0.9em; opacity: 0.95; line-height: 1.6;">
                    <strong>Ø§Ù„ØªØ·ÙˆÙŠØ± Ø§Ù„Ù…Ù‚ØªØ±Ø­:</strong> ${status.advice}
                </div>
            `;
            document.getElementById('status-score').textContent = `Ø§Ù„Ù†ØªÙŠØ¬Ø©: ${clampedScore > 0 ? '+' : ''}${clampedScore}`;
            document.getElementById('status-display').className = `status-indicator ${status.class}`;
        }


// ==================== Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰: exportToPDF ====================

async function exportToPDF(section) {
    const element = document.getElementById(section);
    if (!element) {
        console.error('âŒ Ø§Ù„Ù‚Ø³Ù… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯:', section);
        return;
    }

    console.log('ğŸ”„ Ø¨Ø¯Ø¡ Ø§Ù„ØªÙ‚Ø§Ø· Ø§Ù„ØµÙˆØ±Ø© Ù„Ù„Ù‚Ø³Ù…:', section);
    switchTab(section);
    
    const loadingOverlay = document.getElementById('loadingOverlay');
    loadingOverlay.classList.add('active');

    setTimeout(async () => {
        try {
            console.log('ğŸ“¸ Ø¨Ø¯Ø¡ html2canvas...');
            
            const canvas = await html2canvas(element, {
                scale: 2,
                useCORS: true,
                allowTaint: false,
                logging: true,
                backgroundColor: '#ffffff',
                windowWidth: element.scrollWidth,
                windowHeight: element.scrollHeight
            });

            console.log('âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Canvas:', canvas.width, 'x', canvas.height);
            
            if (canvas.width === 0 || canvas.height === 0) {
                throw new Error('Canvas ÙØ§Ø±Øº');
            }

            const sectionNames = {
                'income': 'ØªØ­Ù„ÙŠÙ„_Ø§Ù„Ø¯Ø®Ù„',
                'expenses': 'ØªØ­Ù„ÙŠÙ„_Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ',
                'analysis': 'ØªØ­Ù„ÙŠÙ„_Ù…ÙˆÙ‚Ù_Ø§Ù„Ø£Ø³Ø±Ø©'
            };
            
            const today = new Date().toISOString().slice(0, 10);
            const fileName = 'ØªØ­Ù„ÙŠÙ„_Ù…Ø¨Ø³Ø·_' + sectionNames[section] + '_' + today + '.png';

            // ØªØ­ÙˆÙŠÙ„ Canvas Ø¥Ù„Ù‰ Data URL
            const dataUrl = canvas.toDataURL('image/png', 0.95);
            
            console.log('âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Data URLØŒ Ø§Ù„Ø­Ø¬Ù…:', dataUrl.length);

            await saveImageToDevice(dataUrl, fileName, loadingOverlay);
            
        } catch (error) {
            console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªÙ‚Ø§Ø· Ø§Ù„ØµÙˆØ±Ø©:', error);
            loadingOverlay.classList.remove('active');
            showErrorMessage('Ø®Ø·Ø£: ' + error.message);
        }
    }, 500);
}


// ==================== Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©: saveImageToDevice (Ø§Ù„Ø­Ù„ Ø§Ù„Ø¬Ø°Ø±ÙŠ) ====================

async function saveImageToDevice(dataUrl, fileName, loadingOverlay) {
    console.log('ğŸ’¾ Ø¨Ø¯Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø­ÙØ¸...');
    
    const tg = window.Telegram && window.Telegram.WebApp ? window.Telegram.WebApp : null;
    const isMobile = /Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
    
    // ================== Ù„Ù„Ù‡Ø§ØªÙ (Telegram): ÙØªØ­ ÙÙŠ Ù…ØªØµÙØ­ Ø®Ø§Ø±Ø¬ÙŠ ==================
    if (isMobile && tg) {
        console.log('ğŸ“± Ø¬Ù‡Ø§Ø² Ù…Ø­Ù…ÙˆÙ„ + Telegram: ÙØªØ­ ÙÙŠ Ù…ØªØµÙØ­ Ø®Ø§Ø±Ø¬ÙŠ');
        
        try {
            // Ø¥Ù†Ø´Ø§Ø¡ HTML ØµÙØ­Ø© Ø¨Ø³ÙŠØ·Ø©
            var pageContent = '<!DOCTYPE html><html dir="rtl"><head><meta charset="UTF-8">';
            pageContent += '<meta name="viewport" content="width=device-width,initial-scale=1">';
            pageContent += '<title>Ø­ÙØ¸ Ø§Ù„ØµÙˆØ±Ø©<\/title><style>';
            pageContent += 'body{margin:0;padding:20px;background:#f5f5f5;font-family:Arial;text-align:center}';
            pageContent += 'img{max-width:100%;height:auto;box-shadow:0 4px 12px rgba(0,0,0,0.15);border-radius:8px;margin:20px 0}';
            pageContent += '.box{background:#fff;padding:20px;margin:20px auto;max-width:90%;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,0.1)}';
            pageContent += 'h2{color:#333;margin:0 0 15px 0}';
            pageContent += 'p{color:#666;line-height:1.8;margin:10px 0}';
            pageContent += 'button{background:#0088cc;color:#fff;border:none;padding:15px 30px;font-size:18px;';
            pageContent += 'border-radius:8px;cursor:pointer;margin:10px;font-weight:bold}';
            pageContent += 'button:active{background:#006699}';
            pageContent += '<\/style><\/head><body>';
            pageContent += '<div class="box"><h2>ğŸ’° ØªØ­Ù„ÙŠÙ„ Ù…Ø¨Ø³Ø·<\/h2>';
            pageContent += '<p><strong>ğŸ“¥ Ù„Ø­ÙØ¸ Ø§Ù„ØµÙˆØ±Ø©:<\/strong><\/p>';
            pageContent += '<p style="font-size:16px">Ù¡. Ø§Ø¶ØºØ· Ù…Ø·ÙˆÙ„Ø§Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ø§Ù„Ø£Ø³ÙÙ„<\/p>';
            pageContent += '<p style="font-size:16px">Ù¢. Ø§Ø®ØªØ± "Ø­ÙØ¸ Ø§Ù„ØµÙˆØ±Ø©" Ø£Ùˆ "Save Image"<\/p>';
            pageContent += '<button onclick="tryDownload()">ğŸ“¥ ØªØ­Ù…ÙŠÙ„ Ù…Ø¨Ø§Ø´Ø±<\/button><\/div>';
            pageContent += '<img src="' + dataUrl + '" alt="Screenshot" id="mainImage">';
            pageContent += '<script>function tryDownload(){';
            pageContent += 'var a=document.createElement("a");';
            pageContent += 'a.href="' + dataUrl + '";';
            pageContent += 'a.download="' + fileName + '";';
            pageContent += 'a.click();';
            pageContent += 'setTimeout(function(){alert("Ø¥Ø°Ø§ Ù„Ù… ÙŠØ¨Ø¯Ø£ Ø§Ù„ØªØ­Ù…ÙŠÙ„ØŒ Ø§Ø¶ØºØ· Ù…Ø·ÙˆÙ„Ø§Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ØµÙˆØ±Ø© ÙˆØ§Ø®ØªØ± \\"Ø­ÙØ¸ Ø§Ù„ØµÙˆØ±Ø©\\"");},500);';
            pageContent += '}<\/script><\/body><\/html>';
            
            // ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ Blob ÙˆØ¥Ù†Ø´Ø§Ø¡ URL
            var blob = new Blob([pageContent], { type: 'text/html' });
            var pageUrl = URL.createObjectURL(blob);
            
            // ÙØªØ­ ÙÙŠ Ù…ØªØµÙØ­ Ø®Ø§Ø±Ø¬ÙŠ
            console.log('ğŸŒ ÙØªØ­ Ø§Ù„Ø±Ø§Ø¨Ø· ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­ Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠ...');
            tg.openLink(pageUrl);
            
            loadingOverlay.classList.remove('active');
            
            setTimeout(function() {
                tg.showAlert('âœ… ØªÙ… ÙØªØ­ ØµÙØ­Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­!\n\nğŸ“¥ Ø§Ø¶ØºØ· Ù…Ø·ÙˆÙ„Ø§Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ØµÙˆØ±Ø© ÙˆØ§Ø®ØªØ± "Ø­ÙØ¸ Ø§Ù„ØµÙˆØ±Ø©"\n\nğŸ’¡ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ù… Ø²Ø± "ØªØ­Ù…ÙŠÙ„ Ù…Ø¨Ø§Ø´Ø±"');
            }, 300);
            
            return;
            
        } catch (error) {
            console.error('âŒ ÙØ´Ù„ ÙØªØ­ Ø§Ù„Ù…ØªØµÙØ­ Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠ:', error);
            // Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ù„Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¨Ø¯ÙŠÙ„Ø©
        }
    }
    
    // ================== Ù„Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ± Ø£Ùˆ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¨Ø¯ÙŠÙ„Ø©: ØªØ­Ù…ÙŠÙ„ Ù…Ø¨Ø§Ø´Ø± ==================
    console.log('ğŸ’» ØªØ­Ù…ÙŠÙ„ Ù…Ø¨Ø§Ø´Ø±...');
    
    try {
        // ØªØ­ÙˆÙŠÙ„ Data URL Ø¥Ù„Ù‰ Blob
        var arr = dataUrl.split(',');
        var mime = arr[0].match(/:(.*?);/)[1];
        var bstr = atob(arr[1]);
        var n = bstr.length;
        var u8arr = new Uint8Array(n);
        
        while(n--){
            u8arr[n] = bstr.charCodeAt(n);
        }
        
        var blob = new Blob([u8arr], {type: mime});
        
        console.log('âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ BlobØŒ Ø§Ù„Ø­Ø¬Ù…:', (blob.size / 1024).toFixed(2), 'KB');
        
        // Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø§Ø¨Ø· Ø§Ù„ØªØ­Ù…ÙŠÙ„
        var url = URL.createObjectURL(blob);
        var link = document.createElement('a');
        link.href = url;
        link.download = fileName;
        link.style.display = 'none';
        
        // Ø¥Ø¶Ø§ÙØ© Ù„Ù„ØµÙØ­Ø© ÙˆØ§Ù„Ù†Ù‚Ø±
        document.body.appendChild(link);
        link.click();
        
        // ØªÙ†Ø¸ÙŠÙ
        setTimeout(function() {
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        }, 100);
        
        loadingOverlay.classList.remove('active');
        
        if (tg && tg.showAlert) {
            tg.showAlert('âœ… ØªÙ… Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ù…ÙŠÙ„!\n\nØ§Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„ØµÙˆØ±Ø© ÙÙŠ Ù…Ø¬Ù„Ø¯ Ø§Ù„ØªÙ†Ø²ÙŠÙ„Ø§Øª');
        } else {
            alert('âœ… ØªÙ… Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ù…ÙŠÙ„! Ø§Ø¨Ø­Ø« ÙÙŠ Ù…Ø¬Ù„Ø¯ Ø§Ù„ØªÙ†Ø²ÙŠÙ„Ø§Øª');
        }
        
        console.log('âœ… ØªÙ… Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­');
        
    } catch (error) {
        console.error('âŒ ÙØ´Ù„ Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±:', error);
        loadingOverlay.classList.remove('active');
        showErrorMessage('ÙØ´Ù„ Ø§Ù„Ø­ÙØ¸: ' + error.message);
    }
}


// ==================== Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø©: showSuccessMessage ====================

function showSuccessMessage(customMessage) {
    var message = customMessage || 'âœ… ØªÙ… Ø§Ù„Ø­ÙØ¸ Ø¨Ù†Ø¬Ø§Ø­!';
    
    if (window.Telegram && window.Telegram.WebApp && window.Telegram.WebApp.showAlert) {
        window.Telegram.WebApp.showAlert(message);
    } else {
        alert(message);
    }
}


// ==================== Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø±Ø§Ø¨Ø¹Ø©: showErrorMessage ====================

function showErrorMessage(customMessage) {
    var message = customMessage || 'âŒ ÙØ´Ù„ Ø§Ù„Ø­ÙØ¸';
    
    if (window.Telegram && window.Telegram.WebApp && window.Telegram.WebApp.showAlert) {
        window.Telegram.WebApp.showAlert(message);
    } else {
        alert(message);
    }
}


        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙØ­Ø©
        document.addEventListener('DOMContentLoaded', function() {
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø¹Ù…Ù„ Ø£ÙˆÙ„Ø§Ù‹
            if (!checkWorkingHours()) {
                return; // Ù„Ø§ ØªÙƒÙ…Ù„ Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø®Ø§Ø±Ø¬ Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø¹Ù…Ù„
            }
            
            loadTheme();
            calculateIncome();
            calculateExpenses();
            wrapTablesForMobile();
            initTelegramWebApp();
            
            
              
                  
                           
            
            
            
            
            
            
        });

        // ØªÙ‡ÙŠØ¦Ø© Telegram Web App
        function initTelegramWebApp() {
            if (window.Telegram && window.Telegram.WebApp) {
                const tg = window.Telegram.WebApp;
                tg.expand();
                tg.enableClosingConfirmation();
                tg.ready();
                
                if (tg.themeParams.bg_color) {
                    document.documentElement.style.setProperty('--tg-bg-color', tg.themeParams.bg_color);
                }
                
                console.log('âœ… Telegram Web App ØªÙ… ØªÙ‡ÙŠØ¦ØªÙ‡ Ø¨Ù†Ø¬Ø§Ø­');
            }
        }

        // ØªØºÙ„ÙŠÙ Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø¹Ø±Ø¶ Ø¹Ù„Ù‰ Ø§Ù„Ù‡ÙˆØ§ØªÙ
        function wrapTablesForMobile() {
            const tables = document.querySelectorAll('table');
            tables.forEach(table => {
                if (!table.parentElement.classList.contains('table-wrapper')) {
                    const wrapper = document.createElement('div');
                    wrapper.className = 'table-wrapper';
                    table.parentNode.insertBefore(wrapper, table);
                    wrapper.appendChild(table);
                }
            });
        }
    </script>
</body>
</html>
